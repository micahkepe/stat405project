---
title: "Group 3: Crash Analysis NYC"
author: "Kevin Lei, Micah Kepe, Zachary Kepe, Giulia Costantini"
date: '2024-02-15'
format:
  pdf: default
  html: default
pdf-engine: pdflatex
editor: visual
fontsize: 10pt
geometry: margin=1in
toc: true                   # add table of contents at the beginning
toc-depth: 2                # Only titles that start with # or ##
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
data <- read.csv("../data/Motor_Vehicle_Collisions_-_Crashes_20240213.csv")
as.data.frame(data)
```

## Introduction

The NYC OpenData dataset contains details of motor vehicle collision occurrences reported by the NYPD from 2013 to 2023. Collisions are only reported if a person was injured or killed, or if there was more than \$1000 in damage. Our project seeks to determine the most important factors that contribute to potentially fatal accidents. By analyzing the data, we hope to identify to provide recommendations for reducing the number of accidents.

## Data Description

The dataset contains over 2 million records, each detailing a motor vehicle collision. The data includes the date, time, location (latitude, longitude, borough), and the number of individuals affected (injured or killed) among drivers, pedestrians, and cyclists. The dataset also includes information about the vehicles involved, such as the type of vehicle and the contributing factors to the crash. Our analysis will focus on understanding patterns and trends within these incidents, and identifying the most important factors that contribute to potentially fatal accidents.

```{r}
summary(data)
head(data)
```

## Data Cleaning
```{r}

# Remove rows with missing values in critical columns
cleaned_data <- data[complete.cases(data[c("BOROUGH", "LATITUDE", "LONGITUDE", "CRASH.DATE", "CRASH.TIME")]), ]

# Convert CRASH.DATE to Date format
cleaned_data$CRASH.DATE <- as.Date(cleaned_data$CRASH.DATE, format="%Y-%m-%d")

# Correct outlier LATITUDE and LONGITUDE values (assuming NYC coordinates)
cleaned_data <- cleaned_data[cleaned_data$LATITUDE > 40 & cleaned_data$LATITUDE < 41 & cleaned_data$LONGITUDE < -73 & cleaned_data$LONGITUDE > -75, ]

# Convert CRASH.TIME to POSIXct format
cleaned_data$CRASH.TIME <- as.POSIXct(cleaned_data$CRASH.TIME, format="%H:%M")

```

## Preliminary Plots

### Plot 1: Frequency of Car Crashes by NYC Borough (2013-2023)

```{r}
# borough <- table(data$BOROUGH)
# 
# table(data$BOROUGH)
# 
# names(borough) <- c("NA", "BRX", "BRN", "MAN", "QNS", "SI")
# 
# barplot(borough, las = 1,
#         main = "Frequency of Car Crashes by NYC Borough (2013-2023)",
#         xlab = "Borough",
#         ylab = "Frequency (in hundreds of thousands)",
#         yaxt = "n")
# 
# axp <- seq(0, 700000, by = 100000)
# axis(2, at = axp, labels = c(0:7), las = 2)

borough_cleaned <- table(cleaned_data$BOROUGH)

names(borough_cleaned) <- c("BRX", "BRN", "MAN", "QNS", "SI")

barplot(borough_cleaned, las = 1,
        main = "Frequency of Car Crashes by NYC Borough (2013-2023)",
        xlab = "Borough",
        ylab = "Frequency",
        col = "blue")

# Adjust the axis to fit the new data range if necessary
axp <- seq(0, max(borough_cleaned), by = 50000)
axis(2, at = axp, labels = axp, las = 2)

```

#### Interpretation

\[add your interpretation here\]

### Plot 2: Histogram of Car Crashes by Time of Day

```{r}

# Extract the hour from the CRASH.TIME column
cleaned_data$Hour <- as.numeric(format(cleaned_data$CRASH.TIME, '%H'))

# Create a histogram of car crashes by time of day
hist(cleaned_data$Hour, breaks = 24, col = "steelblue",
     main = "Car Crashes Frequency by Time of Day",
     xlab = "Hour of the Day",
     ylab = "Number of Crashes")

axis(1, at = seq(0, 23, by = 1), labels = seq(0, 23, by = 1))

```

#### Interpretation

\[add your interpretation here\]

### Plot 3:

```{r}
# Add your plot code here
```

#### Interpretation

\[add your interpretation here\]

### Plot 4:

```{r}
# Add your plot code here
```

#### Interpretation

\[add your interpretation here\]

### Plot 5: Pie Chart of Contributing Factors to Car Crashes

```{r}

# Create a table of contributing factors
factors <- table(cleaned_data$CONTRIBUTING.FACTOR.VEHICLE.1)

# Sort the table in descending order
factors <- sort(factors, decreasing = TRUE)

# Create a pie chart
pie(factors[1:10], 
    labels = names(factors)[1:10],
    main = "Top 10 Contributing Factors to Car Crashes",
    col = rainbow(length(factors)))

```

#### Interpretation

\[add your interpretation here\]

### Plot 6:

```{r}
# Add your plot code here
```

#### Interpretation

\[add your interpretation here\]

## Statistical Modeling: Simple Linear Regression

```{r}
# Add your regression code here

```

#### Interpretation

\[add your interpretation here\]
